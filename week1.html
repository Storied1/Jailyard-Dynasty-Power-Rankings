<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Jailyard 2025 Week 1 Preview & Power Rankings</title>
<meta name="view-transition" content="same-origin" />
<meta name="description" content="The Jailyard 2025 Week 1 preview column. Opening essay, reader mailbag, game picks and matchup predictions from before the season." />

<!--
  This file builds upon the preseason power rankings site and adds a Week 1 preview in the style of a
  long‑form weekly column.  It uses modern CSS for parallax backgrounds, morphing shapes, sticky
  sidebars and subtle animations.  Weekly matchups, predictions and narrative are driven by
  JavaScript objects at the end of the file.
-->

<style>
  :root{
    --bg: #0b0d10;
    --fg: #e8ecf0;
    --muted: #7a8194;
    --accent: #8b5cf6;
    --accent-2: #ec4899;
    --card: rgba(255,255,255,0.04);
    --glass: rgba(255,255,255,0.06);
    --border: rgba(255,255,255,0.08);
    --good: #16a34a;
    --bad: #dc2626;
    --warn: #ca8a04;
    --font-main: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    --h1: clamp(2.4rem, 5vw, 4rem);
    --h2: clamp(1.8rem, 4vw, 3rem);
    --h3: clamp(1.3rem, 3vw, 2rem);
    color-scheme: dark;
  }
  html.light{
    --bg:#f7f9fc; --fg:#111418; --muted:#5f6672;
    --card:rgba(0,0,0,0.03); --glass:rgba(0,0,0,0.04); --border:rgba(0,0,0,0.08);
    color-scheme:light;
  }
  @view-transition{ navigation:auto; }
  ::view-transition-old(root){ animation:vt-out .2s ease-in; }
  ::view-transition-new(root){ animation:vt-in .3s ease-out; }
  @keyframes vt-out{ to{opacity:0;filter:blur(2px);} }
  @keyframes vt-in{ from{opacity:0;filter:blur(2px);} }
  html, body{
    scroll-behavior: smooth;
    margin: 0;
    background: var(--bg);
    color: var(--fg);
    font-family: var(--font-main);
  }
  *, *::before, *::after{ box-sizing: border-box; }
  a{ color: var(--accent-2); text-decoration: none; }
  a:hover{ text-decoration: underline; }
  header.hero{
    position: relative;
    min-height: 90vh;
    overflow: hidden;
    display: grid;
    place-items: center;
  }
  /* Parallax background layers */
  .hero__layer{
    position: absolute;
    inset: 0;
    will-change: transform;
    background-size: cover;
    background-position: center;
  }
  .layer-stars{ background-image: radial-gradient(circle at 30% 30%, rgba(140,115,255,0.3) 0%, transparent 60%), radial-gradient(circle at 70% 70%, rgba(236,72,153,0.3) 0%, transparent 60%), radial-gradient(circle at 20% 80%, rgba(22,163,74,0.25) 0%, transparent 60%), linear-gradient(#101317, #0e1013); }
  .layer-grid{ background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px); background-size: 80px 80px; opacity:.5; }
  .hero__content{ position: relative; z-index: 2; text-align: center; padding: 3rem 1rem; max-width: 900px; }
  .hero__title{ font-size: var(--h1); line-height: 1.1; margin:0; font-weight: 700; background: linear-gradient(96deg,#fff,#e2d9ff 45%,#fda4af 80%); -webkit-background-clip: text; color: transparent; }
  .hero__subtitle{ font-size: 1.1rem; color: var(--muted); max-width: 700px; margin: 1rem auto 2rem; line-height: 1.5; }
  .hero__cta{ display: inline-flex; gap:.6rem; align-items: center; padding: .75rem 1.4rem; background: var(--accent); color:#fff; border-radius:999px; font-weight:600; transition: transform .2s ease; }
  .hero__cta:hover{ transform: translateY(-3px); }
  /* Navigation */
  #nav{ position: sticky; top: 0; z-index: 10; backdrop-filter: blur(8px); background: rgba(11,13,16,.7); border-bottom:1px solid var(--border); }
  #nav .inner{ max-width:1200px; margin:0 auto; padding:.7rem 1rem; display:flex; justify-content: space-between; align-items:center; }
  #nav .brand{ font-weight:700; letter-spacing:.05em; }
  #nav nav{ display:flex; gap:.8rem; flex-wrap: wrap; }
  #nav nav a{ padding:.35rem .6rem; border-radius:6px; font-size:.9rem; color: var(--muted); }
  #nav nav a.active{ background:rgba(255,255,255,0.05); color: var(--fg); }
  #nav .right{ display:flex; gap:.8rem; align-items:center; }
  .theme-toggle{ cursor:pointer; padding:.4rem .8rem; border:1px solid var(--border); border-radius:999px; background:rgba(255,255,255,0.05); font-size:.9rem; color:var(--muted); }
  #nav .hamburger{display:none;background:none;border:none;cursor:pointer;padding:.4rem;color:var(--muted);transition:color .2s;}
  #nav .hamburger:hover,#nav .hamburger:focus-visible{color:var(--fg);}
  #nav .hamburger svg{width:24px;height:24px;stroke:currentColor;fill:none;stroke-width:2;}
  /* Sections */
  .container{ max-width: 1200px; margin:0 auto; padding:4rem 1rem; position:relative; }
  .section-title{ font-size: var(--h2); margin-bottom:.7rem; }
  .section-sub{ color: var(--muted); font-size:1rem; margin-bottom:2.5rem; max-width:700px; line-height:1.6; }
  .card{ background: var(--card); border:1px solid var(--border); border-radius:16px; padding:1.3rem 1.5rem; margin-bottom:1.2rem; box-shadow:0 6px 18px rgba(0,0,0,.18); transition: transform .2s ease, box-shadow .2s ease; }
  .card:hover{ transform: translateY(-4px); box-shadow:0 10px 30px rgba(0,0,0,.22); }
  /* Week preview layout */
  .week-section{ margin-top:3rem; }
  .week-header{ font-size:var(--h2); margin-bottom:1rem; }
  .essay{ font-size:1rem; line-height:1.6; margin-bottom:2rem; }
  .mailbag-item{ margin-bottom:1.5rem; }
  .mailbag-item h4{ margin:.2rem 0; font-size:1.1rem; color: var(--accent); }
  .mailbag-item p{ margin:.4rem 0 0; color: var(--muted); }
  .picks-table{ width:100%; border-collapse: collapse; margin-top:1.5rem; }
  .picks-table th, .picks-table td{ padding:.55rem .75rem; border-bottom:1px solid rgba(255,255,255,0.08); font-size:.95rem; }
  .picks-table th{ text-align:left; color: var(--muted); font-weight:500; background:rgba(255,255,255,0.03); position:sticky; top:0; }
  .picks-table td:last-child{ font-style:italic; color: var(--muted); }
  .tag-badge{ display:inline-block; padding:.1rem .45rem; margin-left:.4rem; border-radius:6px; font-size:.8rem; font-weight:500; }
  .tag-upset{ background:rgba(236,72,153,0.2); color:#ec4899; }
  .tag-stay{ background:rgba(234,179,8,0.2); color:#eab308; }
  .tag-teaser{ background:rgba(139,92,246,0.2); color:#8b5cf6; }
  /* Sticky sidebar for records */
  .sidebar{ position:sticky; top:5rem; padding:1.5rem; border:1px solid var(--border); border-radius:12px; background:var(--glass); max-width:260px; }
  .sidebar h4{ margin-top:0; margin-bottom:.6rem; font-size:1.1rem; }
  .sidebar p{ margin:.3rem 0; font-size:.9rem; color:var(--muted); }

  /* Morphing shape separators */
  .separator{
    position: relative;
    height:120px;
    overflow:hidden;
  }
  .separator svg{
    position:absolute;
    width:100%;
    height:100%;
    left:0;
    top:0;
  }

  /* Footer */
  footer{ padding:3rem 1rem; text-align:center; color:var(--muted); font-size:.9rem; border-top:1px solid var(--border); }

  /* --- Matchup cards (replaces table) --- */
  .matchup-grid{ display:grid; gap:1rem; margin-top:1.5rem; }
  .matchup-card{
    background:var(--card); border:1px solid var(--border); border-radius:14px;
    padding:1.2rem 1.4rem; transition:transform .2s,box-shadow .2s;
    opacity:0; transform:translateY(15px); transition:all .5s cubic-bezier(.17,.67,.24,1);
  }
  .matchup-card.visible{ opacity:1; transform:none; }
  .matchup-card:hover{ transform:translateY(-3px); box-shadow:0 8px 24px rgba(0,0,0,.2); }
  .matchup-header{
    display:flex; align-items:center; justify-content:space-between; gap:.8rem; margin-bottom:.8rem; flex-wrap:wrap;
  }
  .matchup-header .team-name{ font-weight:700; font-size:1rem; flex:1; min-width:100px; }
  .matchup-header .team-name.home{ text-align:right; }
  .matchup-header .vs-pill{
    padding:.15rem .6rem; border-radius:999px; font-size:.75rem; font-weight:700; letter-spacing:.04em;
    background:rgba(139,92,246,0.12); color:var(--accent); flex-shrink:0;
  }
  .win-prob-bar{
    height:8px; border-radius:999px; overflow:hidden; display:flex; margin-bottom:.6rem;
    background:rgba(255,255,255,0.06);
  }
  .win-prob-bar .home-bar{ background:linear-gradient(90deg,var(--accent),#a78bfa); transition:width 1s cubic-bezier(.2,.8,.2,1); }
  .win-prob-bar .away-bar{ background:linear-gradient(90deg,var(--accent-2),#f472b6); transition:width 1s cubic-bezier(.2,.8,.2,1); }
  .prob-labels{
    display:flex; justify-content:space-between; font-size:.78rem; color:var(--muted); margin-bottom:.6rem;
  }
  .matchup-blurb{ font-size:.9rem; color:var(--muted); line-height:1.5; }
  .matchup-pick{
    display:inline-flex; align-items:center; gap:.3rem; margin-top:.6rem;
    font-size:.82rem; font-weight:600; color:var(--good);
  }
  .matchup-pick svg{ width:14px; height:14px; stroke:currentColor; fill:none; stroke-width:2; }

  /* --- Scroll animations --- */
  .fade-in{ opacity:0; transform:translateY(20px); transition:all .6s cubic-bezier(.17,.67,.24,1); }
  .fade-in.visible{ opacity:1; transform:none; }

  /* --- Special picks strip --- */
  .special-picks{
    display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1rem; margin-top:2rem;
  }
  .special-pick{
    padding:1rem; border-radius:12px; border:1px solid var(--border); background:var(--card); text-align:center;
  }
  .special-pick .sp-label{ font-size:.75rem; text-transform:uppercase; letter-spacing:.06em; color:var(--muted); margin-bottom:.4rem; font-weight:600; }
  .special-pick .sp-value{ font-weight:700; font-size:.95rem; }

  /* --- Back to top --- */
  .back-to-top{position:fixed;bottom:1.5rem;right:1.5rem;z-index:997;width:44px;height:44px;border-radius:50%;background:rgba(11,13,16,0.85);backdrop-filter:blur(8px);border:1px solid var(--border);display:grid;place-items:center;cursor:pointer;opacity:0;transform:translateY(10px);transition:opacity .3s,transform .3s,background .2s;pointer-events:none;}
  .back-to-top.show{opacity:1;transform:none;pointer-events:auto;}
  .back-to-top:hover{background:var(--accent);}
  .back-to-top svg{width:20px;height:20px;stroke:var(--fg);fill:none;stroke-width:2;}

  @media (max-width:768px){
    .picks-table th,.picks-table td{ padding:.4rem .5rem; }
    .sidebar{ position:static; max-width:none; margin-bottom:2rem; }
    .matchup-header .team-name{ font-size:.9rem; }
    #nav .hamburger{display:block;}
    #nav nav{display:none;width:100%;}
    #nav nav.open{display:flex;flex-direction:column;gap:0;}
    #nav .inner{flex-wrap:wrap;}
  }
.scroll-progress{position:fixed;top:0;left:0;height:3px;z-index:200;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%;transition:width .1s linear;pointer-events:none;}
</style>
</head>
<body>
<div class="scroll-progress" id="scrollProgress"></div>
<header class="hero">
  <div class="hero__layer layer-stars" data-speed="0.2"></div>
  <div class="hero__layer layer-grid" data-speed="0.05"></div>
  <div class="hero__content">
    <h1 class="hero__title">The Jailyard Week 1 Preview</h1>
    <p class="hero__subtitle">The 2025 season opener. Opening essay, reader mailbag, bold predictions and every matchup breakdown for the first week of the dynasty campaign.</p>
    <a href="#week1" class="hero__cta">Jump to Picks ↓</a>
  </div>
</header>
<div id="nav">
  <div class="inner">
    <div class="brand"><a href="index.html" style="color:inherit;text-decoration:none;" data-league-name>The Jailyard</a></div>
    <nav>
      <a href="history.html">League Bible</a>
      <a href="season.html">Season Hub</a>
      <a href="preseason.html">Rankings</a>
      <a href="draft.html">Draft</a>
      <a href="trades.html">Trades</a>
      <a href="#week1">Week 1 Preview</a>
    </nav>
    <div class="right">
      <button class="theme-toggle" id="toggleTheme">Toggle Theme</button>
    </div>
    <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
      <svg viewBox="0 0 24 24"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
  </div>
</div>

<main>
  <!-- Week 1 preview section -->
  <section class="container week-section" id="week1">
    <h2 class="week-header">Week 1 Preview & Picks</h2>
    <div class="section-sub">A long‑form essay, reader mailbag, bits and our picks for each matchup. Records start fresh: 0–0 overall, 0–0 underdog locks.</div>
    <div style="display:flex; flex-wrap:wrap; gap:2rem;">
      <div style="flex:2 1 650px; min-width:300px;">
        <article class="card essay" id="week1-essay"></article>
        <article class="card" id="week1-mailbag"></article>
        <article class="card" id="week1-bits"></article>
        <article class="card" id="week1-picks"></article>
      </div>
      <div class="sidebar" id="week1-sidebar">
        <h4>Week 1 Ledger</h4>
        <p>Overall record: 0–0</p>
        <p>Underdog Locks: 0–0</p>
        <p>Stay‑Away: 0–0</p>
        <p>Teaser of the Week: 0–0</p>
        <p class="small" style="margin-top:1rem;">Reminder: Our picks are for entertainment. Don’t bet your rent money.</p>
      </div>
    </div>
  </section>

</main>

<!-- Back to top -->
<button class="back-to-top" id="backToTop" aria-label="Back to top">
  <svg viewBox="0 0 24 24"><path d="M12 19V5M5 12l7-7 7 7"/></svg>
</button>

<footer>
  <div style="font-weight:700;font-size:1rem;color:var(--fg);margin-bottom:.4rem;">The Jailyard</div>
  <div style="display:flex;flex-wrap:wrap;justify-content:center;gap:.8rem;margin-bottom:1rem;">
    <a href="index.html" style="color:var(--muted);font-size:.85rem;">Home</a>
    <a href="history.html" style="color:var(--muted);font-size:.85rem;">League Bible</a>
    <a href="season.html" style="color:var(--muted);font-size:.85rem;">Season Hub</a>
    <a href="preseason.html" style="color:var(--muted);font-size:.85rem;">Rankings</a>
    <a href="draft.html" style="color:var(--muted);font-size:.85rem;">Draft Recap</a>
    <a href="trades.html" style="color:var(--muted);font-size:.85rem;">Trades</a>
    <a href="week1.html" style="color:var(--muted);font-size:.85rem;">Week 1</a>
  </div>
  &copy; 2022&ndash;2026 The Jailyard Dynasty League. Built with love.
</footer>

<script src="config.js"></script>
<script>
// Theme toggle
document.getElementById('toggleTheme').addEventListener('click', ()=>{
  document.documentElement.classList.toggle('light');
});

// Parallax scrolling effect for hero layers
window.addEventListener('scroll', ()=>{
  const sc = window.scrollY;
  document.querySelectorAll('.hero__layer').forEach(layer => {
    const speed = parseFloat(layer.getAttribute('data-speed') || 0);
    layer.style.transform = `translateY(${sc * speed}px)`;
  });
});

// Data for week 1 article and picks
const week1Essay = `The long offseason is finally over.  Training‑camp hype videos have given way to roster cuts, depth chart debates and half‑cooked preseason takes.  Now the dynasty season begins in earnest.  Our league spent the summer debating whether Barkley’s knee can hold up, what a second‑year leap for Caleb Williams might look like and which team is quietly plotting a rebuild.  This year opens with more questions than answers.  Will General Ken‑obi reclaim his throne after a shocking early exit last fall?  Can Kittler on the Roof defend his title with a roster held together by duct tape and magic?  Will MHJTIME’s arsenal of wide receivers overwhelm opponents, or will his running backs derail another promising run?  In the NFL proper, the biggest storylines include second‑year quarterbacks trying to avoid the sophomore slump, a wave of electric young wideouts and the usual quarterback controversies.  We’ll be watching it all through the lens of The Jailyard.  Buckle up: this column aims to blend hard truths with humour, just like your favourite sports writer did back in the day.`;

const week1Mailbag = [
  {
    q: 'Dear Commish: Why do I keep betting on the Falcons?',
    a: 'Because you’re drawn to chaos like a moth to a flame.  Also because Arthur Smith can’t hurt you anymore.  Just remember: hope is not a strategy.'
  },
  {
    q: 'Hey Expert: Does having four starting quarterbacks count as hoarding?',
    a: 'Only if you refuse to trade them when your competitors lose theirs.  Otherwise it’s called depth.'
  },
  {
    q: 'Is this the year the Lions finally break out?',
    a: 'I ask myself this every August and then watch them blow a 14‑point lead in November.  Proceed with caution.'
  }
];

const week1Bits = `Great Call of the Week: Watching MHJTIME start three rookie RBs when Jahmyr Gibbs is on bye.\n\nParent Corner: Explaining to your kids that yes, you drafted a player named De’Von and no, he does not play with their classmate Devon.\n\nNobody Believes in Us: Chudders Football Team enters the week projected for the lowest points but might sneak a win thanks to Herbert and Gibbs.`;

// Week 1 matchup predictions
const week1Matches = [
  {
    home: 'General Ken‑obi', away: 'The Boonist Monks', spread: -2.0,
    pick: 'General Ken‑obi',
    blurb: 'Two former champions square off.  General’s depth and QB rotation should be enough to outlast Lamar, Tyreek and Kelce.  Our model gives him a narrow edge.',
  },
  {
    home: 'Noble FFT', away: 'Sleeping Giants', spread: -1.0,
    pick: 'Noble FFT',
    blurb: 'Bijan and Breece versus Hurts and a group of aging receivers.  This might be close, but we trust the younger legs of Noble FFT in a modest upset.',
  },
  {
    home: 'MHJTIME', away: 'Burden of Etienne‑y Woody', spread: -4.0,
    pick: 'MHJTIME',
    blurb: 'The WR arsenal meets a team with one and a half running backs.  Unless Kyler returns to 2021 form, MHJTIME should coast.',
  },
  {
    home: 'Rasheeing the Scene', away: 'Father Time', spread: 0,
    pick: 'Rasheeing the Scene',
    blurb: 'Allen plus three rookies against a spoiler team of veterans and rookies.  Expect fireworks but give the edge to the higher ceiling.',
  },
  {
    home: 'Ghastly Grayskull Gang', away: 'Chudders Football Team', spread: -5.0,
    pick: 'Ghastly Grayskull Gang',
    blurb: 'Stroud and Bowers versus a rebuild in progress.  Ghastly has the weapons to control this game; it might not be close.',
  },
  {
    home: 'Kittler on the Roof', away: 'The Legion of Bouz', spread: -2.0,
    pick: 'Kittler on the Roof',
    blurb: 'The defending champ opens against the original champ.  It’s closer on paper than you’d think, but we lean Kittler due to roster balance.',
    tag: 'Upset watch'
  }
];

// Week 1 categories
const underdogLock = 'The Legion of Bouz +2';
const stayAway = 'Noble FFT vs Sleeping Giants';
const teaser = 'Parlay MHJTIME -4 with Ghastly -5';

// Convert spread to approximate win probability (logistic model)
function spreadToProb(spread){
  // positive spread = home favored; returns home win %
  return 1 / (1 + Math.pow(10, -spread / 7));
}

function renderWeek1(){
  // Essay
  document.getElementById('week1-essay').innerHTML = `<h3>Opening Essay</h3><p>${week1Essay.replace(/\n/g,'<br>')}</p>`;
  document.getElementById('week1-essay').classList.add('fade-in');
  // Mailbag
  let mbHtml = '<h3>Mailbag & Q&A</h3>';
  week1Mailbag.forEach(item => {
    mbHtml += `<div class="mailbag-item"><h4>${item.q}</h4><p>${item.a}</p></div>`;
  });
  document.getElementById('week1-mailbag').innerHTML = mbHtml;
  document.getElementById('week1-mailbag').classList.add('fade-in');
  // Bits
  document.getElementById('week1-bits').innerHTML = `<h3>Bits & Segments</h3><p>${week1Bits.replace(/\n/g,'<br>')}</p>`;
  document.getElementById('week1-bits').classList.add('fade-in');

  // Matchup cards with win probability bars
  let picksHtml = '<h3>Game Picks</h3><div class="matchup-grid">';
  week1Matches.forEach(match => {
    const homeProb = spreadToProb(match.spread);
    const awayProb = 1 - homeProb;
    const homePct = (homeProb * 100).toFixed(0);
    const awayPct = (awayProb * 100).toFixed(0);
    const tag = match.tag || '';
    let tagHtml = '';
    if(tag){
      if(tag.toLowerCase().includes('upset')) tagHtml = ' <span class="tag-badge tag-upset">Upset Watch</span>';
    }
    picksHtml += `
      <div class="matchup-card" data-home-pct="${homePct}" data-away-pct="${awayPct}">
        <div class="matchup-header">
          <span class="team-name home">${match.home}</span>
          <span class="vs-pill">${match.spread > 0 ? '+' : ''}${match.spread}</span>
          <span class="team-name">${match.away}</span>
        </div>
        <div class="win-prob-bar">
          <div class="home-bar" style="width:0%"></div>
          <div class="away-bar" style="width:0%"></div>
        </div>
        <div class="prob-labels">
          <span>${homePct}%</span>
          <span>Win probability</span>
          <span>${awayPct}%</span>
        </div>
        <p class="matchup-blurb">${match.blurb}</p>
        <div class="matchup-pick">
          <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
          Pick: ${match.pick}${tagHtml}
        </div>
      </div>`;
  });
  picksHtml += '</div>';

  // Special picks strip
  picksHtml += `
    <div class="special-picks">
      <div class="special-pick">
        <div class="sp-label">Underdog Lock</div>
        <div class="sp-value">${underdogLock}</div>
      </div>
      <div class="special-pick">
        <div class="sp-label" style="color:var(--warn)">Stay Away</div>
        <div class="sp-value">${stayAway}</div>
      </div>
      <div class="special-pick">
        <div class="sp-label" style="color:var(--accent)">Teaser of the Week</div>
        <div class="sp-value">${teaser}</div>
      </div>
    </div>`;

  document.getElementById('week1-picks').innerHTML = picksHtml;
  document.getElementById('week1-picks').classList.add('fade-in');
}

renderWeek1();

// --- Scroll animations ---
const scrollObserver = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if(e.isIntersecting){
      e.target.classList.add('visible');
      // Animate win probability bars
      const homeBar = e.target.querySelector('.home-bar');
      const awayBar = e.target.querySelector('.away-bar');
      if(homeBar && awayBar){
        requestAnimationFrame(() => {
          homeBar.style.width = e.target.dataset.homePct + '%';
          awayBar.style.width = e.target.dataset.awayPct + '%';
        });
      }
      scrollObserver.unobserve(e.target);
    }
  });
}, { threshold: 0.15 });
document.querySelectorAll('.fade-in, .matchup-card').forEach(el => scrollObserver.observe(el));

// --- Active nav link highlighting ---
const navAnchors = document.querySelectorAll('#nav nav a');
const navSpy = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if(e.isIntersecting && e.target.id){
      navAnchors.forEach(a => a.classList.toggle('active', a.getAttribute('href') === '#' + e.target.id));
    }
  });
}, { rootMargin: '-30% 0px -60% 0px', threshold: 0 });
document.querySelectorAll('section[id]').forEach(el => navSpy.observe(el));

// --- Back to top ---
const btt = document.getElementById('backToTop');
window.addEventListener('scroll', () => {
  btt.classList.toggle('show', window.scrollY > 500);
}, { passive: true });
btt.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

// --- Mobile hamburger menu ---
document.getElementById('hamburger').addEventListener('click', () => {
  document.querySelector('#nav nav').classList.toggle('open');
});
document.querySelectorAll('#nav nav a').forEach(a => {
  a.addEventListener('click', () => document.querySelector('#nav nav').classList.remove('open'));
});

// --- Scroll progress bar ---
(function(){
  const bar = document.getElementById('scrollProgress');
  window.addEventListener('scroll', () => {
    const h = document.documentElement.scrollHeight - window.innerHeight;
    bar.style.width = h > 0 ? (window.scrollY / h * 100) + '%' : '0%';
  }, {passive:true});
})();

applyConfig();
</script>
</body>
</html>